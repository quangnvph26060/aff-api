import{u as R}from"./useFormatCurrency-ovqMsPCw.js";import{p as N,n as D,r as u,q as U,d as i,o as r,e as f,f as o,w as n,B as d,v as $,h as C,g as q,u as Y,E as H,x as z,z as A,a9 as P,aa as J,F as E,G as K,ad as Q,ac as X}from"./vendor-BYqNKCR2.js";import{a as Z}from"./main-B_y2_4ec.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";function O(){const F=Z.baseURL,y={data:[],teamRevenue:0},l=N({wallet_type:"",method:"",amount:"",status:"pending"}),_={accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")};return{responseWallet:y,formData:l,postTransactionRequest:async c=>{try{const g=await axios.post(`${F}responseWallet`,{formData:c},{headers:_})}catch(g){console.error("Failed to fetch team members:",g)}},getTransactionAll:async()=>{try{const c=await axios.get(`${F}transactionlist`,{headers:_});c.status===200&&(y.data=c.data)}catch(c){console.error("Failed to fetch transactions:",c)}}}}const te={class:"flex gap-5"},ae=D({__name:"Withdraw",setup(F){const{postTransactionRequest:y,formData:l}=O(),_=Y(),p=u("");H();const b=u(0),c=u(0),g=u(0),k=u(1),B=u(),V=u("");U(async()=>{const e=await _.getters.user;p.value=e,e&&e.wallet.length>0&&(b.value=e==null?void 0:e.wallet[0].total_revenue,c.value=e==null?void 0:e.wallet[1].total_revenue)});const T=u({method:!0,wallet_type:!1,amount:!1});async function a(){T.value.method=!1,l.wallet_type=k.value,l.amount=g.value,l.method=V.value;let e=!1;l.method===""&&(T.value.method=!0,e=!0),l.wallet_type===""&&(T.value.wallet_type=!0,e=!0),(l.amount===null||+l.amount<=1e4)&&(T.value.amount=!0,e=!0),e||await y(l)}const t=u("Chọn phương thức"),h=u("Chọn ví"),I=()=>{},W=e=>{e==1?(k.value=1,B.value=b.value):e==2&&(k.value=2,B.value=c.value)},L=e=>{V.value=e};return(e,s)=>{const S=i("a-descriptions-item"),w=i("a-descriptions"),m=i("a-select-option"),x=i("a-select"),j=i("a-input-number"),G=i("a-button"),M=i("a-card");return r(),f("div",null,[o(M,{title:"Yêu cầu rút tiền",bordered:!1,class:"w-100"},{default:n(()=>[o(w,{title:"Số dư"},{default:n(()=>[o(S,{label:"Số dư ví chính"},{default:n(()=>[d($(C(R)(b.value)),1)]),_:1}),o(S,{label:"Số dư ví thưởng"},{default:n(()=>[d($(C(R)(c.value)),1)]),_:1})]),_:1}),q("div",te,[o(x,{ref:"select",value:h.value,"onUpdate:value":s[0]||(s[0]=v=>h.value=v),style:{width:"200px"},onFocus:I,onChange:s[1]||(s[1]=v=>W(h.value))},{default:n(()=>[o(m,{value:"1"},{default:n(()=>[d("Ví chính")]),_:1}),o(m,{value:"2"},{default:n(()=>[d("Ví thưởng")]),_:1})]),_:1},8,["value"]),o(x,{ref:"select",value:t.value,"onUpdate:value":s[2]||(s[2]=v=>t.value=v),style:{width:"200px"},onFocus:I,onChange:s[3]||(s[3]=v=>L(t.value))},{default:n(()=>[o(m,{value:"0"},{default:n(()=>[d("Tiền mặt")]),_:1}),o(m,{value:"1"},{default:n(()=>[d("Chuyển khoản")]),_:1})]),_:1},8,["value"]),o(j,{value:g.value,"onUpdate:value":s[4]||(s[4]=v=>g.value=v),formatter:v=>`đ ${v}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),min:1e4,step:1e3,max:B.value,class:"w-[200px]"},null,8,["value","formatter","max"]),o(G,{class:"bg-secondary text-white",onClick:a},{default:n(()=>[d("Tạo yêu cầu rút tiền")]),_:1})])]),_:1})])}}}),ne=ee(ae,[["__scopeId","data-v-b6440bc7"]]),oe={key:0,style:{color:"#1890ff"}},se={style:{padding:"8px"}},le={key:0},re=D({__name:"Payment",setup(F){const{responseWallet:y,getTransactionAll:l}=O(),_=u([]);U(async()=>{await l(),_.value=y.data,console.log(_.value)});const p=N({searchText:"",searchedColumn:""}),b=u(),c=a=>{switch(a){case"pending":return"processing";case"completed":return"success";default:return""}},g=[{title:"Kỳ đối soát",dataIndex:"created_at"},{title:"Ví",dataIndex:"wallet_id",customRender:({text:a})=>a===1?"Ví chính":"Ví thưởng"},{title:"Số dư trong kỳ",dataIndex:"amount",sorter:{compare:(a,t)=>a.balance-t.balance},customRender:({text:a,record:t})=>R(t.amount)},{title:"Thuế thu nhập",dataIndex:"tax",sorter:{compare:(a,t)=>a.tax-t.tax},customRender:({text:a,record:t})=>R(t.amount?t.amount*.1:"0")},{title:"Số dư thực nhận",dataIndex:"balance_received",sorter:{compare:(a,t)=>a.balance_received-t.balance_received},customRender:({text:a,record:t})=>{const h=t.amount-t.amount*.1;return R(h)}},{title:"Trạng thái",dataIndex:"status",filters:[{text:"đã thanh toán",value:"completed"},{text:"chờ xác nhận",value:"pending"}],onFilter:(a,t)=>t.level.indexOf(a)==="pending"}],k=(a,t,h)=>{t(),p.searchText=a[0],p.searchedColumn=h},B=a=>{a({confirm:!0}),p.searchText=""},V=N({pageSize:10,showSizeChanger:!0,responsive:!0,showLessItems:!0,onChange:(a,t)=>{}});function T(a,t,h,I){}return(a,t)=>{const h=i("a-input"),I=i("a-button"),W=i("a-tag"),L=i("a-table");return r(),z(L,{"data-source":_.value.data,columns:g,pagination:V,scroll:{x:1200},onChange:T},{headerCell:n(({column:e})=>[e.key==="name"?(r(),f("span",oe,"Name")):A("",!0)]),customFilterDropdown:n(({setSelectedKeys:e,selectedKeys:s,confirm:S,clearFilters:w,column:m})=>[q("div",se,[o(h,{ref_key:"searchInput",ref:b,placeholder:`Tìm ${m.title}`,value:s[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:x=>e(x.target.value?[x.target.value]:[]),onPressEnter:x=>k(s,S,m.dataIndex)},null,8,["placeholder","value","onChange","onPressEnter"]),o(I,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:x=>k(s,S,m.dataIndex)},{icon:n(()=>[o(C(P))]),default:n(()=>[d(" Tìm ")]),_:2},1032,["onClick"]),o(I,{size:"small",style:{width:"90px"},onClick:x=>B(w)},{default:n(()=>[d(" Đặt lại ")]),_:2},1032,["onClick"])])]),customFilterIcon:n(({filtered:e})=>[o(C(P),{style:J({color:e?"#108ee9":void 0})},null,8,["style"])]),bodyCell:n(({text:e,column:s,record:S})=>[p.searchText&&p.searchedColumn===s.dataIndex?(r(),f("span",le,[(r(!0),f(E,null,K(e.toString().split(new RegExp(`(?<=${p.searchText})|(?=${p.searchText})`,"i")),(w,m)=>(r(),f(E,null,[w.toLowerCase()===p.searchText.toLowerCase()?(r(),f("mark",{key:m,class:"highlight"},$(w),1)):(r(),f(E,{key:1},[d($(w),1)],64))],64))),256))])):A("",!0),s.dataIndex==="status"?(r(),z(W,{key:1,color:c(e),class:"inline-flex items-center"},{icon:n(()=>[e==="pending"?(r(),z(C(Q),{key:0,spin:!0})):(r(),z(C(X),{key:1}))]),default:n(()=>[d(" "+$(e==="pending"?"chờ xác nhận":"đã thanh toán"),1)]),_:2},1032,["color"])):s.dataIndex==="balance"?(r(),f(E,{key:2},[d($(C(R)(e)),1)],64)):A("",!0)]),_:1},8,["data-source","pagination"])}}}),pe=D({__name:"index",setup(F){return(y,l)=>{const _=i("a-card");return r(),f("div",null,[o(ne),o(_,{title:"Lịch sử thanh toán",bordered:!1,class:"w-100"},{default:n(()=>[o(re,{class:"mt-5"})]),_:1})])}}});export{pe as default};
