import{u as S}from"./useFormatCurrency-ovqMsPCw.js";import{p as N,n as D,r as c,q as U,d as u,o as r,e as g,f as o,w as n,B as i,v as R,h as C,g as q,u as Y,E as G,x as V,z as L,a9 as P,aa as J,F as A,H as K,ad as Q,ac as X}from"./vendor-Dg8UqXFD.js";import{a as Z}from"./main-B7mYjJu2.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";function O(){const $=Z.baseURL,y={data:[],teamRevenue:0},p=N({wallet_type:"",method:"",amount:"",status:"pending"}),m={accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")};return{responseWallet:y,formData:p,postTransactionRequest:async v=>{try{const l=await axios.post(`${$}responseWallet`,{formData:v},{headers:m})}catch(l){console.error("Failed to fetch team members:",l)}},getTransactionAll:async()=>{const v={Accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")};try{const l=await axios.get(`${$}transactionlist`,{headers:v});l.status===200&&(y.data=l.data)}catch(l){console.error("Failed to fetch transactions:",l)}}}}const te={class:"flex gap-5"},ae=D({__name:"Withdraw",setup($){const{postTransactionRequest:y,formData:p}=O(),m=Y(),d=c("");G();const b=c(0),v=c(0),l=c(0),k=c(1),B=c(),F=c("");U(async()=>{const e=await m.getters.user;d.value=e,e&&e.wallet.length>0&&(b.value=e==null?void 0:e.wallet[0].total_revenue,v.value=e==null?void 0:e.wallet[1].total_revenue)});const z=c({method:!1});async function a(){if(z.value.method=!1,p.wallet_type=k.value,p.amount=l.value,p.method=F.value,p.method===""){z.value.method=!0;return}await y(p)}const t=c("Chọn phương thức"),h=c("Chọn ví"),T=()=>{},W=e=>{e==1?(k.value=1,B.value=b.value):e==2&&(k.value=2,B.value=v.value)},E=e=>{F.value=e};return(e,s)=>{const I=u("a-descriptions-item"),w=u("a-descriptions"),_=u("a-select-option"),x=u("a-select"),j=u("a-input-number"),H=u("a-button"),M=u("a-card");return r(),g("div",null,[o(M,{title:"Yêu cầu rút tiền",bordered:!1,class:"w-100"},{default:n(()=>[o(w,{title:"Số dư"},{default:n(()=>[o(I,{label:"Số dư ví chính"},{default:n(()=>[i(R(C(S)(b.value)),1)]),_:1}),o(I,{label:"Số dư ví thưởng"},{default:n(()=>[i(R(C(S)(v.value)),1)]),_:1})]),_:1}),q("div",te,[o(x,{ref:"select",value:h.value,"onUpdate:value":s[0]||(s[0]=f=>h.value=f),style:{width:"200px"},onFocus:T,onChange:s[1]||(s[1]=f=>W(h.value))},{default:n(()=>[o(_,{value:"1"},{default:n(()=>[i("Ví chính")]),_:1}),o(_,{value:"2"},{default:n(()=>[i("Ví thưởng")]),_:1})]),_:1},8,["value"]),o(x,{ref:"select",value:t.value,"onUpdate:value":s[2]||(s[2]=f=>t.value=f),style:{width:"200px"},onFocus:T,onChange:s[3]||(s[3]=f=>E(t.value))},{default:n(()=>[o(_,{value:"0"},{default:n(()=>[i("Tiền mặt")]),_:1}),o(_,{value:"1"},{default:n(()=>[i("Chuyển khoản")]),_:1})]),_:1},8,["value"]),o(j,{value:l.value,"onUpdate:value":s[4]||(s[4]=f=>l.value=f),formatter:f=>`đ ${f}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),min:1e4,step:1e3,max:B.value,class:"w-[200px]"},null,8,["value","formatter","max"]),o(H,{class:"bg-secondary text-white",onClick:a},{default:n(()=>[i("Tạo yêu cầu rút tiền")]),_:1})])]),_:1})])}}}),ne=ee(ae,[["__scopeId","data-v-5af6ec14"]]),oe={key:0,style:{color:"#1890ff"}},se={style:{padding:"8px"}},le={key:0},re=D({__name:"Payment",setup($){const{responseWallet:y,getTransactionAll:p}=O(),m=c([]);U(async()=>{await p(),m.value=y.data,console.log(m.value)});const d=N({searchText:"",searchedColumn:""}),b=c(),v=a=>{switch(a){case"pending":return"processing";case"completed":return"success";default:return""}},l=[{title:"Kỳ đối soát",dataIndex:"created_at"},{title:"Ví",dataIndex:"wallet_id",customRender:({text:a})=>a===1?"Ví chính":"Ví thưởng"},{title:"Số dư trong kỳ",dataIndex:"amount",sorter:{compare:(a,t)=>a.balance-t.balance},customRender:({text:a,record:t})=>S(t.amount)},{title:"Thuế thu nhập",dataIndex:"tax",sorter:{compare:(a,t)=>a.tax-t.tax},customRender:({text:a,record:t})=>S(t.amount?t.amount*.1:"0")},{title:"Số dư thực nhận",dataIndex:"balance_received",sorter:{compare:(a,t)=>a.balance_received-t.balance_received},customRender:({text:a,record:t})=>{const h=t.amount-t.amount*.1;return S(h)}},{title:"Trạng thái",dataIndex:"status",filters:[{text:"đã thanh toán",value:"completed"},{text:"chờ xác nhận",value:"pending"}],onFilter:(a,t)=>t.level.indexOf(a)==="pending"}],k=(a,t,h)=>{t(),d.searchText=a[0],d.searchedColumn=h},B=a=>{a({confirm:!0}),d.searchText=""},F=N({pageSize:10,showSizeChanger:!0,responsive:!0,showLessItems:!0,onChange:(a,t)=>{}});function z(a,t,h,T){}return(a,t)=>{const h=u("a-input"),T=u("a-button"),W=u("a-tag"),E=u("a-table");return r(),V(E,{"data-source":m.value.data,columns:l,pagination:F,scroll:{x:1200},onChange:z},{headerCell:n(({column:e})=>[e.key==="name"?(r(),g("span",oe,"Name")):L("",!0)]),customFilterDropdown:n(({setSelectedKeys:e,selectedKeys:s,confirm:I,clearFilters:w,column:_})=>[q("div",se,[o(h,{ref_key:"searchInput",ref:b,placeholder:`Tìm ${_.title}`,value:s[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:x=>e(x.target.value?[x.target.value]:[]),onPressEnter:x=>k(s,I,_.dataIndex)},null,8,["placeholder","value","onChange","onPressEnter"]),o(T,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:x=>k(s,I,_.dataIndex)},{icon:n(()=>[o(C(P))]),default:n(()=>[i(" Tìm ")]),_:2},1032,["onClick"]),o(T,{size:"small",style:{width:"90px"},onClick:x=>B(w)},{default:n(()=>[i(" Đặt lại ")]),_:2},1032,["onClick"])])]),customFilterIcon:n(({filtered:e})=>[o(C(P),{style:J({color:e?"#108ee9":void 0})},null,8,["style"])]),bodyCell:n(({text:e,column:s,record:I})=>[d.searchText&&d.searchedColumn===s.dataIndex?(r(),g("span",le,[(r(!0),g(A,null,K(e.toString().split(new RegExp(`(?<=${d.searchText})|(?=${d.searchText})`,"i")),(w,_)=>(r(),g(A,null,[w.toLowerCase()===d.searchText.toLowerCase()?(r(),g("mark",{key:_,class:"highlight"},R(w),1)):(r(),g(A,{key:1},[i(R(w),1)],64))],64))),256))])):L("",!0),s.dataIndex==="status"?(r(),V(W,{key:1,color:v(e),class:"inline-flex items-center"},{icon:n(()=>[e==="pending"?(r(),V(C(Q),{key:0,spin:!0})):(r(),V(C(X),{key:1}))]),default:n(()=>[i(" "+R(e==="pending"?"chờ xác nhận":"đã thanh toán"),1)]),_:2},1032,["color"])):s.dataIndex==="balance"?(r(),g(A,{key:2},[i(R(C(S)(e)),1)],64)):L("",!0)]),_:1},8,["data-source","pagination"])}}}),pe=D({__name:"index",setup($){return(y,p)=>{const m=u("a-card");return r(),g("div",null,[o(ne),o(m,{title:"Lịch sử thanh toán",bordered:!1,class:"w-100"},{default:n(()=>[o(re,{class:"mt-5"})]),_:1})])}}});export{pe as default};
